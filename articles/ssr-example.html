<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sample size re-estimation example â€¢ gsDesignNB</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample size re-estimation example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesignNB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesignNB/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sample size re-estimation example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesignNB/blob/main/vignettes/ssr-example.Rmd" class="external-link"><code>vignettes/ssr-example.Rmd</code></a></small>
      <div class="d-none name"><code>ssr-example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesignNB/">gsDesignNB</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesign/" class="external-link">gsDesign</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates a group sequential trial with a single
interim analysis where unblinded sample size re-estimation (SSR) is
performed.</p>
<p>We simulate a scenario where the <strong>control event rate is lower
than assumed</strong> and the <strong>dispersion is higher than
assumed</strong>. Both factors lead to slower information accumulation
(or higher variance) than planned. We will show how to:</p>
<ol style="list-style-type: decimal">
<li>Monitor information accumulation at an interim analysis.</li>
<li>Re-estimate the required sample size (or duration) to achieve the
target power.</li>
<li>Adjust the final analysis bounds if the final information differs
from the plan.</li>
</ol>
</div>
<div class="section level2">
<h2 id="trial-setup-and-initial-design">Trial setup and initial design<a class="anchor" aria-label="anchor" href="#trial-setup-and-initial-design"></a>
</h2>
<p><strong>Planned parameters:</strong></p>
<ul>
<li>Control rate (<span class="math inline">\(\lambda_1\)</span>): 0.1
events/month</li>
<li>Experimental rate (<span class="math inline">\(\lambda_2\)</span>):
0.075 events/month (Hazard Ratio = 0.75)</li>
<li>Dispersion (<span class="math inline">\(k\)</span>): 0.5</li>
<li>Power: 90%</li>
<li>One-sided Type I error (<span class="math inline">\(\alpha\)</span>): 0.025</li>
<li>Enrollment: 20 patients/month for 12 months (Total N = 240)</li>
<li>Study duration: 24 months</li>
</ul>
<p><strong>Actual parameters (simulation truth):</strong></p>
<ul>
<li>Control rate (<span class="math inline">\(\lambda_1\)</span>): 0.08
events/month (Lower than planned)</li>
<li>Experimental rate (<span class="math inline">\(\lambda_2\)</span>):
0.06 events/month (HR = 0.75 maintained)</li>
<li>Dispersion (<span class="math inline">\(k\)</span>): 0.65 (Higher
than planned)</li>
</ul>
<div class="section level3">
<h3 id="initial-sample-size-calculation">Initial sample size calculation<a class="anchor" aria-label="anchor" href="#initial-sample-size-calculation"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Planned parameters</span></span>
<span><span class="va">lambda1_plan</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">lambda2_plan</span> <span class="op">&lt;-</span> <span class="fl">0.075</span></span>
<span><span class="va">k_plan</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">power_plan</span> <span class="op">&lt;-</span> <span class="fl">0.9</span></span>
<span><span class="va">alpha_plan</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">accrual_rate_plan</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">accrual_dur_plan</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">trial_dur_plan</span> <span class="op">&lt;-</span> <span class="fl">24</span></span>
<span></span>
<span><span class="co"># Calculate sample size</span></span>
<span><span class="va">design_plan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_size_nbinom.html">sample_size_nbinom</a></span><span class="op">(</span></span>
<span>  lambda1 <span class="op">=</span> <span class="va">lambda1_plan</span>,</span>
<span>  lambda2 <span class="op">=</span> <span class="va">lambda2_plan</span>,</span>
<span>  dispersion <span class="op">=</span> <span class="va">k_plan</span>,</span>
<span>  power <span class="op">=</span> <span class="va">power_plan</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_plan</span>,</span>
<span>  accrual_rate <span class="op">=</span> <span class="va">accrual_rate_plan</span>,</span>
<span>  accrual_duration <span class="op">=</span> <span class="va">accrual_dur_plan</span>,</span>
<span>  trial_duration <span class="op">=</span> <span class="va">trial_dur_plan</span>,</span>
<span>  max_followup <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to group sequential design</span></span>
<span><span class="va">gs_plan</span> <span class="op">&lt;-</span> <span class="va">design_plan</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="../reference/gsNBCalendar.html">gsNBCalendar</a></span><span class="op">(</span></span>
<span>     k <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     test.type <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Non-binding futility</span></span>
<span>     alpha <span class="op">=</span> <span class="va">alpha_plan</span>,</span>
<span>     sfu <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>     sfupar <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, <span class="co"># Moderately aggressive alpha-spending</span></span>
<span>     sfl <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>     sflpar <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Pocock-like futility spending</span></span>
<span>     analysis_times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">accrual_dur_plan</span> <span class="op">-</span> <span class="fl">2</span>, <span class="va">trial_dur_plan</span><span class="op">)</span></span>
<span>   <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">gsDesignNB</span><span class="fu">::</span><span class="fu"><a href="../reference/toInteger.html">toInteger</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Round to integer sample size</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gs_plan</span><span class="op">)</span></span>
<span><span class="co">#&gt; Asymmetric two-sided with non-binding futility bound group sequential design</span></span>
<span><span class="co">#&gt; for negative binomial outcomes, 2 analyses, total sample size 882.0, 90 percent</span></span>
<span><span class="co">#&gt; power, 2.5 percent (1-sided) Type I error. Control rate 0.1000, treatment rate</span></span>
<span><span class="co">#&gt; 0.0750, risk ratio 0.7500, dispersion 0.5000. Accrual duration 12.0, trial</span></span>
<span><span class="co">#&gt; duration 24.0, max follow-up 12.0, average exposure 12.00. Randomization ratio</span></span>
<span><span class="co">#&gt; 1:1. Upper spending: Hwang-Shih-DeCani (gamma = -2) Lower spending:</span></span>
<span><span class="co">#&gt; Hwang-Shih-DeCani (gamma = 1)</span></span>
<span><span class="co">#&gt; Asymmetric two-sided with non-binding futility bound group sequential design</span></span>
<span><span class="co">#&gt; for negative binomial outcomes, 2 analyses, total sample size 882.0, 90 percent</span></span>
<span><span class="co">#&gt; power, 2.5 percent (1-sided) Type I error. Control rate 0.1000, treatment rate</span></span>
<span><span class="co">#&gt; 0.0750, risk ratio 0.7500, dispersion 0.5000. Accrual duration 12.0, trial</span></span>
<span><span class="co">#&gt; duration 24.0, max follow-up 12.0, average exposure 12.00. Randomization ratio</span></span>
<span><span class="co">#&gt; 1:1. Upper spending: Hwang-Shih-DeCani (gamma = -2) Lower spending:</span></span>
<span><span class="co">#&gt; Hwang-Shih-DeCani (gamma = 1)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsBoundSummary.html" class="external-link">gsBoundSummary</a></span><span class="op">(</span><span class="va">gs_plan</span>,</span>
<span>    deltaname <span class="op">=</span> <span class="st">"RR"</span>,</span>
<span>    logdelta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    Nname <span class="op">=</span> <span class="st">"Information"</span>,</span>
<span>    timename <span class="op">=</span> <span class="st">"Month"</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    ddigits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Group Sequential Design Bounds for Negative Binomial Outcome"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"N = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">gs_plan</span><span class="op">$</span><span class="va">n_total</span><span class="op">[</span><span class="va">gs_plan</span><span class="op">$</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="st">", Expected events = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">gs_plan</span><span class="op">$</span><span class="va">nb_design</span><span class="op">$</span><span class="va">total_events</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="4" class="gt_heading gt_title gt_font_normal" style>Group Sequential Design Bounds for Negative Binomial Outcome</td>
    </tr>
<tr class="gt_heading">
<td colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>N = 882, Expected events = 785.4</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Value">Value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Efficacy">Efficacy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Futility">Futility</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Analysis" class="gt_row gt_left">IA 1: 43%</td>
<td headers="Value" class="gt_row gt_left">Z</td>
<td headers="Efficacy" class="gt_row gt_right">2.5498</td>
<td headers="Futility" class="gt_row gt_right">0.7234</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Information: 64.85</td>
<td headers="Value" class="gt_row gt_left">p (1-sided)</td>
<td headers="Efficacy" class="gt_row gt_right">0.0054</td>
<td headers="Futility" class="gt_row gt_right">0.2347</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Month: 10</td>
<td headers="Value" class="gt_row gt_left">~RR at bound</td>
<td headers="Efficacy" class="gt_row gt_right">0.7286</td>
<td headers="Futility" class="gt_row gt_right">0.9141</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=1</td>
<td headers="Efficacy" class="gt_row gt_right">0.0054</td>
<td headers="Futility" class="gt_row gt_right">0.7653</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=0.75</td>
<td headers="Efficacy" class="gt_row gt_right">0.4077</td>
<td headers="Futility" class="gt_row gt_right">0.0556</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Final</td>
<td headers="Value" class="gt_row gt_left">Z</td>
<td headers="Efficacy" class="gt_row gt_right">2.0152</td>
<td headers="Futility" class="gt_row gt_right">2.0152</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Information: 149.77</td>
<td headers="Value" class="gt_row gt_left">p (1-sided)</td>
<td headers="Efficacy" class="gt_row gt_right">0.0219</td>
<td headers="Futility" class="gt_row gt_right">0.0219</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Month: 24</td>
<td headers="Value" class="gt_row gt_left">~RR at bound</td>
<td headers="Efficacy" class="gt_row gt_right">0.8481</td>
<td headers="Futility" class="gt_row gt_right">0.8481</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=1</td>
<td headers="Efficacy" class="gt_row gt_right">0.0219</td>
<td headers="Futility" class="gt_row gt_right">0.9781</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=0.75</td>
<td headers="Efficacy" class="gt_row gt_right">0.9027</td>
<td headers="Futility" class="gt_row gt_right">0.0973</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>We simulate the trial with the same rate ratio, but lower actual
rates and a higher dispersion. We will limit the maximum sample size to
40% more than the planned size (i.e., max N = ) to avoid unbounded
increases.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Actual parameters</span></span>
<span><span class="va">lambda1_true</span> <span class="op">&lt;-</span> <span class="fl">0.08</span> <span class="co"># Lower event rates, same rr</span></span>
<span><span class="va">lambda2_true</span> <span class="op">&lt;-</span> <span class="fl">0.06</span></span>
<span><span class="va">k_true</span> <span class="op">&lt;-</span> <span class="fl">0.65</span> <span class="co"># Higher dispersion</span></span>
<span></span>
<span><span class="co"># Enrollment and rates for simulation</span></span>
<span><span class="co"># We simulate a larger pool to allow for potential sample size increase</span></span>
<span><span class="va">enroll_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="va">accrual_rate_plan</span>, duration <span class="op">=</span> <span class="va">accrual_dur_plan</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> </span>
<span><span class="va">fail_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Experimental"</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lambda1_true</span>, <span class="va">lambda2_true</span><span class="op">)</span>,</span>
<span>  dispersion <span class="op">=</span> <span class="va">k_true</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dropout_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Experimental"</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nb_sim.html">nb_sim</a></span><span class="op">(</span></span>
<span>  enroll_rate <span class="op">=</span> <span class="va">enroll_rate</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="va">fail_rate</span>,</span>
<span>  dropout_rate <span class="op">=</span> <span class="va">dropout_rate</span>,</span>
<span>  max_followup <span class="op">=</span> <span class="va">trial_dur_plan</span>, </span>
<span>  n <span class="op">=</span> <span class="fl">600</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Limit to planned enrollment for the initial cut</span></span>
<span><span class="co"># We will "open" more enrollment if needed</span></span>
<span><span class="va">sim_data_planned</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">design_plan</span><span class="op">$</span><span class="va">n_total</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interim-analysis">Interim analysis<a class="anchor" aria-label="anchor" href="#interim-analysis"></a>
</h2>
<p>We perform an interim analysis at <strong>Month 10</strong>, which is
2 months prior to the end of planned enrollment (Month 12).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interim_time</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">interim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cut_data_by_date.html">cut_data_by_date</a></span><span class="op">(</span><span class="va">sim_data_planned</span>, cut_date <span class="op">=</span> <span class="va">interim_time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">interim_data</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Control Experimental </span></span>
<span><span class="co">#&gt;           99           98</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">interim_data</span><span class="op">$</span><span class="va">events</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 69</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">interim_data</span><span class="op">$</span><span class="va">tte</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.086404</span></span></code></pre></div>
<div class="section level3">
<h3 id="information-computation">Information computation<a class="anchor" aria-label="anchor" href="#information-computation"></a>
</h3>
<p>We calculate the statistical information accumulated so far.</p>
<p><strong>Blinded Information:</strong> Calculated assuming a common
rate and dispersion, often used for monitoring without unblinding.</p>
<p><strong>Unblinded Information:</strong> Calculated using the observed
rates and dispersion in each group. This is the true Fisher information
for the log rate ratio.</p>
<p><span class="math display">\[ \mathcal{I} = \left(
\frac{1}{\text{Var}(\hat{\beta}_{trt})} \right) \]</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Blinded SSR</span></span>
<span><span class="va">blinded_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blinded_ssr.html">blinded_ssr</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">interim_data</span>,</span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda1_planning <span class="op">=</span> <span class="va">lambda1_plan</span>,</span>
<span>  lambda2_planning <span class="op">=</span> <span class="va">lambda2_plan</span>,</span>
<span>  power <span class="op">=</span> <span class="va">power_plan</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_plan</span>,</span>
<span>  accrual_rate <span class="op">=</span> <span class="va">accrual_rate_plan</span>,</span>
<span>  accrual_duration <span class="op">=</span> <span class="va">accrual_dur_plan</span>,</span>
<span>  trial_duration <span class="op">=</span> <span class="va">trial_dur_plan</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unblinded SSR</span></span>
<span><span class="va">ssr_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unblinded_ssr.html">unblinded_ssr</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">interim_data</span>,</span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda1_planning <span class="op">=</span> <span class="va">lambda1_plan</span>,</span>
<span>  lambda2_planning <span class="op">=</span> <span class="va">lambda2_plan</span>,</span>
<span>  power <span class="op">=</span> <span class="va">power_plan</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_plan</span>,</span>
<span>  accrual_rate <span class="op">=</span> <span class="va">accrual_rate_plan</span>,</span>
<span>  accrual_duration <span class="op">=</span> <span class="va">accrual_dur_plan</span>,</span>
<span>  trial_duration <span class="op">=</span> <span class="va">trial_dur_plan</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Blinded SSR N:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">blinded_res</span><span class="op">$</span><span class="va">n_total_blinded</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Blinded SSR N: 914</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Unblinded SSR N:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">ssr_res</span><span class="op">$</span><span class="va">n_total_unblinded</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unblinded SSR N: 888</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ssr_res</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_total_unblinded</span></span>
<span><span class="co">#&gt; (Intercept) </span></span>
<span><span class="co">#&gt;         888 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dispersion_unblinded</span></span>
<span><span class="co">#&gt; [1] 0.8891071</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda1_unblinded</span></span>
<span><span class="co">#&gt; (Intercept) </span></span>
<span><span class="co">#&gt;  0.07878905 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lambda2_unblinded</span></span>
<span><span class="co">#&gt; (Intercept) </span></span>
<span><span class="co">#&gt;  0.05726336 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $info_fraction</span></span>
<span><span class="co">#&gt; [1] 0.0950141</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $unblinded_info</span></span>
<span><span class="co">#&gt; [1] 12.06309</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $target_info</span></span>
<span><span class="co">#&gt; [1] 126.9611</span></span></code></pre></div>
<p>The estimated control rate is 0.079, which is lower than the planned
0.1. The information fraction is 0.095.</p>
</div>
<div class="section level3">
<h3 id="sample-size-re-estimation">Sample size re-estimation<a class="anchor" aria-label="anchor" href="#sample-size-re-estimation"></a>
</h3>
<p>Since the control rate is lower and dispersion is higher, the
information accumulates slower than planned. To maintain power, we need
to increase the sample size or follow-up.</p>
<p>The <code>unblinded_ssr</code> function estimates the required total
sample size to be 888. We ensure the sample size is at least as large as
the planned sample size.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_planned</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">design_plan</span><span class="op">$</span><span class="va">n_total</span><span class="op">)</span></span>
<span><span class="va">n_estimated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">ssr_res</span><span class="op">$</span><span class="va">n_total_unblinded</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure we don't decrease sample size</span></span>
<span><span class="va">n_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">n_planned</span>, <span class="va">n_estimated</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">n_final</span> <span class="op">&gt;</span> <span class="va">n_planned</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Increasing sample size from"</span>, <span class="va">n_planned</span>, <span class="st">"to"</span>, <span class="va">n_final</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate new durations based on constant accrual rate</span></span>
<span>  <span class="co"># We extend enrollment to reach the new target N</span></span>
<span>  <span class="va">new_accrual_dur</span> <span class="op">&lt;-</span> <span class="va">n_final</span> <span class="op">/</span> <span class="va">accrual_rate_plan</span></span>
<span>  </span>
<span>  <span class="co"># We maintain the planned max follow-up of 12 months</span></span>
<span>  <span class="co"># So the trial duration extends by the same amount as the accrual duration</span></span>
<span>  <span class="va">new_trial_dur</span> <span class="op">&lt;-</span> <span class="va">new_accrual_dur</span> <span class="op">+</span> <span class="fl">12</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"New Accrual Duration:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">new_accrual_dur</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"months\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"New Trial Duration:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">new_trial_dur</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"months\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No sample size increase needed.\n"</span><span class="op">)</span></span>
<span>  <span class="va">new_accrual_dur</span> <span class="op">&lt;-</span> <span class="va">accrual_dur_plan</span></span>
<span>  <span class="va">new_trial_dur</span> <span class="op">&lt;-</span> <span class="va">trial_dur_plan</span></span>
<span>  <span class="va">n_final</span> <span class="op">&lt;-</span> <span class="va">n_planned</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Increasing sample size from 748 to 888 </span></span>
<span><span class="co">#&gt; New Accrual Duration: 44.4 months</span></span>
<span><span class="co">#&gt; New Trial Duration: 56.4 months</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="final-analysis">Final analysis<a class="anchor" aria-label="anchor" href="#final-analysis"></a>
</h2>
<p>We proceed to the final analysis at Month 56.4. We include the
additional patients if the sample size was increased.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Update the dataset to include the additional patients</span></span>
<span><span class="va">sim_data_final</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_final</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Cut at final analysis time</span></span>
<span><span class="va">final_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cut_data_by_date.html">cut_data_by_date</a></span><span class="op">(</span><span class="va">sim_data_final</span>, cut_date <span class="op">=</span> <span class="va">new_trial_dur</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Average exposure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">final_data</span><span class="op">$</span><span class="va">tte</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 23.95368</span></span>
<span></span>
<span><span class="co"># Fit final model</span></span>
<span><span class="va">fit_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></span><span class="op">(</span><span class="va">events</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">tte</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">final_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_final</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm.nb(formula = events ~ treatment + offset(log(tte)), data = final_data, </span></span>
<span><span class="co">#&gt;     init.theta = 1.782870921, link = log)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)           -2.58248    0.08222 -31.411   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; treatmentExperimental -0.14688    0.11826  -1.242    0.214    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for Negative Binomial(1.7829) family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 364.75  on 330  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 363.20  on 329  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 1166</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Theta:  1.783 </span></span>
<span><span class="co">#&gt;           Std. Err.:  0.316 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  2 x log-likelihood:  -1159.959</span></span>
<span></span>
<span><span class="co"># Calculate final information</span></span>
<span><span class="va">var_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit_final</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">final_info</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">var_beta</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Final Information:"</span>, <span class="va">final_info</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Final Information: 71.50829</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Target Information:"</span>, <span class="va">ssr_res</span><span class="op">$</span><span class="va">target_info</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Target Information: 126.9611</span></span></code></pre></div>
<div class="section level3">
<h3 id="updating-bounds">Updating bounds<a class="anchor" aria-label="anchor" href="#updating-bounds"></a>
</h3>
<p>If the final information differs from the target (e.g., it is lower),
we need to adjust the critical values to ensure we spend exactly <span class="math inline">\(\alpha\)</span>. We use the <code>gsDesign</code>
package with <code>usTime</code> (user-specified information fraction)
to update the bounds.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Information fraction at final analysis</span></span>
<span><span class="co"># If final_info &lt; target_info, fraction &lt; 1. </span></span>
<span><span class="co"># However, for the final analysis, we typically want to spend all remaining alpha.</span></span>
<span><span class="co"># We can treat the current info as the "maximum" info for the spending function.</span></span>
<span></span>
<span><span class="co"># Example group sequential design (O'Brien-Fleming spending)</span></span>
<span><span class="co"># We assume the interim was at the observed information fraction</span></span>
<span><span class="va">info_fractions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ssr_res</span><span class="op">$</span><span class="va">info_fraction</span>, <span class="va">final_info</span> <span class="op">/</span> <span class="va">ssr_res</span><span class="op">$</span><span class="va">target_info</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If final fraction &lt; 1, we can force it to 1 to spend all alpha, </span></span>
<span><span class="co"># effectively accepting the lower power.</span></span>
<span><span class="co"># Or we can use the actual information fractions in a spending function approach.</span></span>
<span></span>
<span><span class="co"># Let's assume we want to spend all alpha at the final analysis regardless of info.</span></span>
<span><span class="co"># We set the final timing to 1.</span></span>
<span><span class="va">info_fractions_spending</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ssr_res</span><span class="op">$</span><span class="va">info_fraction</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update bounds</span></span>
<span><span class="va">gs_update</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_plan</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfLDOF</span>,</span>
<span>  usTime <span class="op">=</span> <span class="va">info_fractions_spending</span>,</span>
<span>  n.I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ssr_res</span><span class="op">$</span><span class="va">unblinded_info</span>, <span class="va">final_info</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsBoundSummary.html" class="external-link">gsBoundSummary</a></span><span class="op">(</span><span class="va">gs_update</span>,</span>
<span>    deltaname <span class="op">=</span> <span class="st">"RR"</span>,</span>
<span>    logdelta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    Nname <span class="op">=</span> <span class="st">"Information"</span>,</span>
<span>    timename <span class="op">=</span> <span class="st">"Month"</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    ddigits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Updated Group Sequential Design Bounds"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"Final Information = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">final_info</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="akjkbwjige" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#akjkbwjige table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#akjkbwjige thead, #akjkbwjige tbody, #akjkbwjige tfoot, #akjkbwjige tr, #akjkbwjige td, #akjkbwjige th {
  border-style: none;
}

#akjkbwjige p {
  margin: 0;
  padding: 0;
}

#akjkbwjige .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#akjkbwjige .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#akjkbwjige .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#akjkbwjige .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#akjkbwjige .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akjkbwjige .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akjkbwjige .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akjkbwjige .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#akjkbwjige .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#akjkbwjige .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#akjkbwjige .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#akjkbwjige .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#akjkbwjige .gt_spanner_row {
  border-bottom-style: hidden;
}

#akjkbwjige .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#akjkbwjige .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#akjkbwjige .gt_from_md > :first-child {
  margin-top: 0;
}

#akjkbwjige .gt_from_md > :last-child {
  margin-bottom: 0;
}

#akjkbwjige .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#akjkbwjige .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#akjkbwjige .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#akjkbwjige .gt_row_group_first td {
  border-top-width: 2px;
}

#akjkbwjige .gt_row_group_first th {
  border-top-width: 2px;
}

#akjkbwjige .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akjkbwjige .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#akjkbwjige .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#akjkbwjige .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akjkbwjige .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akjkbwjige .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#akjkbwjige .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#akjkbwjige .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#akjkbwjige .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akjkbwjige .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akjkbwjige .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akjkbwjige .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akjkbwjige .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akjkbwjige .gt_left {
  text-align: left;
}

#akjkbwjige .gt_center {
  text-align: center;
}

#akjkbwjige .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#akjkbwjige .gt_font_normal {
  font-weight: normal;
}

#akjkbwjige .gt_font_bold {
  font-weight: bold;
}

#akjkbwjige .gt_font_italic {
  font-style: italic;
}

#akjkbwjige .gt_super {
  font-size: 65%;
}

#akjkbwjige .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#akjkbwjige .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#akjkbwjige .gt_indent_1 {
  text-indent: 5px;
}

#akjkbwjige .gt_indent_2 {
  text-indent: 10px;
}

#akjkbwjige .gt_indent_3 {
  text-indent: 15px;
}

#akjkbwjige .gt_indent_4 {
  text-indent: 20px;
}

#akjkbwjige .gt_indent_5 {
  text-indent: 25px;
}

#akjkbwjige .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#akjkbwjige div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="3" class="gt_heading gt_title gt_font_normal" style>Updated Group Sequential Design Bounds</td>
    </tr>
<tr class="gt_heading">
<td colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Final Information = 71.51</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Value">Value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Efficacy">Efficacy</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Analysis" class="gt_row gt_left">IA 1: 17%</td>
<td headers="Value" class="gt_row gt_left">Z</td>
<td headers="Efficacy" class="gt_row gt_right">7.1773</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Information: 12.06</td>
<td headers="Value" class="gt_row gt_left">p (1-sided)</td>
<td headers="Efficacy" class="gt_row gt_right">0.0000</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">~RR at bound</td>
<td headers="Efficacy" class="gt_row gt_right">1.8918</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=1</td>
<td headers="Efficacy" class="gt_row gt_right">0.0000</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=2.72</td>
<td headers="Efficacy" class="gt_row gt_right">1.0000</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Final</td>
<td headers="Value" class="gt_row gt_left">Z</td>
<td headers="Efficacy" class="gt_row gt_right">1.9600</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Information: 71.51</td>
<td headers="Value" class="gt_row gt_left">p (1-sided)</td>
<td headers="Efficacy" class="gt_row gt_right">0.0250</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">~RR at bound</td>
<td headers="Efficacy" class="gt_row gt_right">1.0741</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=1</td>
<td headers="Efficacy" class="gt_row gt_right">0.0250</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=2.72</td>
<td headers="Efficacy" class="gt_row gt_right">1.0000</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Test statistic</span></span>
<span><span class="va">z_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_final</span><span class="op">)</span><span class="op">[</span><span class="st">"treatmentExperimental"</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_beta</span><span class="op">)</span></span>
<span><span class="co"># Note: gsDesign assumes Z &gt; 0 for efficacy. </span></span>
<span><span class="co"># Our model gives log(RR) &lt; 0 for efficacy.</span></span>
<span><span class="co"># So Z_stat = - (log(RR)) / SE</span></span>
<span><span class="va">z_stat</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_final</span><span class="op">)</span><span class="op">[</span><span class="st">"treatmentExperimental"</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_beta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Z-statistic:"</span>, <span class="va">z_stat</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Z-statistic: 1.24208</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Final Bound:"</span>, <span class="va">gs_update</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Final Bound: 1.959964</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">z_stat</span> <span class="op">&gt;</span> <span class="va">gs_update</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Reject Null Hypothesis\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fail to Reject Null Hypothesis\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Fail to Reject Null Hypothesis</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
